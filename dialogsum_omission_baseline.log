Parameter 'function'=<function get_datasets.<locals>.preprocess_function at 0x7151496b2430> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
Round 1
Start Training!
Sample 3371 of the training set: {'input_ids': [0, 21714, 1215, 3761, 1360, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 407, 47, 26, 47, 8, 10641, 1145, 149, 10, 7628, 1441, 4, 1336, 222, 24, 1369, 116, 50118, 10431, 41761, 176, 10431, 35, 2647, 6, 127, 25537, 21, 964, 19, 10641, 6, 98, 37, 2942, 201, 4, 50118, 10431, 41761, 134, 10431, 35, 6553, 37, 1137, 47, 99, 79, 21, 101, 78, 116, 50118, 10431, 41761, 176, 10431, 35, 3216, 6, 37, 1602, 69, 7, 162, 6, 8, 79, 12020, 101, 127, 1907, 4, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.6142, 'rouge2': 5.8673, 'rougeL': 17.5556, 'rougeLsum': 27.0066}, 'ppl': {'perplexity': 5.0879, 'ref_perplexity': 27.3629}, 'bertscore': {'precision': 83.7335, 'recall': 84.4296, 'f1': 84.0747}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.0811, 'rouge2': 4.3886, 'rougeL': 16.9141, 'rougeLsum': 23.5263}, 'ppl': {'perplexity': 2.1492, 'ref_perplexity': 19.6814}, 'bertscore': {'precision': 86.782, 'recall': 84.7543, 'f1': 85.7522}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 22.9997, 'rouge2': 3.8269, 'rougeL': 16.5957, 'rougeLsum': 22.057}, 'ppl': {'perplexity': 3.163, 'ref_perplexity': 16.6532}, 'bertscore': {'precision': 86.2208, 'recall': 84.3691, 'f1': 85.2815}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.8957, 'rouge2': 5.4741, 'rougeL': 16.8116, 'rougeLsum': 25.3464}, 'ppl': {'perplexity': 5.9845, 'ref_perplexity': 14.9034}, 'bertscore': {'precision': 84.3049, 'recall': 84.7575, 'f1': 84.5261}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 28.025, 'rouge2': 4.5765, 'rougeL': 17.0653, 'rougeLsum': 27.2993}, 'ppl': {'perplexity': 5.2427, 'ref_perplexity': 13.8183}, 'bertscore': {'precision': 84.7004, 'recall': 84.9841, 'f1': 84.8357}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.7725, 'rouge2': 4.491, 'rougeL': 16.6925, 'rougeLsum': 26.1431}, 'ppl': {'perplexity': 8.3338, 'ref_perplexity': 13.176}, 'bertscore': {'precision': 85.1873, 'recall': 84.8423, 'f1': 85.0101}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.4986, 'rouge2': 4.6955, 'rougeL': 16.1764, 'rougeLsum': 25.712}, 'ppl': {'perplexity': 11.6708, 'ref_perplexity': 12.8085}, 'bertscore': {'precision': 84.2508, 'recall': 85.0076, 'f1': 84.6214}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.4271, 'rouge2': 3.8801, 'rougeL': 16.5355, 'rougeLsum': 25.5464}, 'ppl': {'perplexity': 5.1343, 'ref_perplexity': 12.7188}, 'bertscore': {'precision': 84.9915, 'recall': 84.7611, 'f1': 84.8703}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.767, 'rouge2': 4.3861, 'rougeL': 15.9609, 'rougeLsum': 25.0696}, 'ppl': {'perplexity': 11.102, 'ref_perplexity': 12.6924}, 'bertscore': {'precision': 84.5581, 'recall': 84.8513, 'f1': 84.6976}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.946, 'rouge2': 3.9119, 'rougeL': 15.9391, 'rougeLsum': 25.2142}, 'ppl': {'perplexity': 20.9032, 'ref_perplexity': 12.774}, 'bertscore': {'precision': 84.4588, 'recall': 84.8424, 'f1': 84.6435}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.399, 'rouge2': 3.8585, 'rougeL': 15.9376, 'rougeLsum': 24.6608}, 'ppl': {'perplexity': 11.7765, 'ref_perplexity': 12.9186}, 'bertscore': {'precision': 84.7369, 'recall': 84.8897, 'f1': 84.8073}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.2604, 'rouge2': 4.1482, 'rougeL': 16.1252, 'rougeLsum': 25.4861}, 'ppl': {'perplexity': 13.8155, 'ref_perplexity': 13.1447}, 'bertscore': {'precision': 84.7792, 'recall': 84.8654, 'f1': 84.8155}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2551, 'rouge2': 3.6574, 'rougeL': 15.6557, 'rougeLsum': 24.5029}, 'ppl': {'perplexity': 98.9498, 'ref_perplexity': 13.3852}, 'bertscore': {'precision': 84.5157, 'recall': 84.8012, 'f1': 84.6517}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.9225, 'rouge2': 3.9402, 'rougeL': 15.9904, 'rougeLsum': 25.1204}, 'ppl': {'perplexity': 9.4247, 'ref_perplexity': 13.7386}, 'bertscore': {'precision': 84.4558, 'recall': 84.7326, 'f1': 84.5868}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.152, 'rouge2': 3.5973, 'rougeL': 15.494, 'rougeLsum': 24.3943}, 'ppl': {'perplexity': 10.7879, 'ref_perplexity': 14.0258}, 'bertscore': {'precision': 84.7038, 'recall': 84.8214, 'f1': 84.7555}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.8761, 'rouge2': 3.4983, 'rougeL': 15.3386, 'rougeLsum': 24.1175}, 'ppl': {'perplexity': 8.8681, 'ref_perplexity': 14.352}, 'bertscore': {'precision': 84.3698, 'recall': 84.7703, 'f1': 84.5621}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.9504, 'rouge2': 3.6913, 'rougeL': 15.8434, 'rougeLsum': 25.1728}, 'ppl': {'perplexity': 6.7307, 'ref_perplexity': 14.656}, 'bertscore': {'precision': 84.4994, 'recall': 84.8335, 'f1': 84.6598}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4075, 'rouge2': 3.612, 'rougeL': 15.6945, 'rougeLsum': 24.6077}, 'ppl': {'perplexity': 8.822, 'ref_perplexity': 14.8904}, 'bertscore': {'precision': 84.6061, 'recall': 84.7908, 'f1': 84.6911}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.8073, 'rouge2': 3.6274, 'rougeL': 15.6683, 'rougeLsum': 25.0372}, 'ppl': {'perplexity': 12.2364, 'ref_perplexity': 15.0938}, 'bertscore': {'precision': 84.352, 'recall': 84.7925, 'f1': 84.5643}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0785, 'rouge2': 3.8168, 'rougeL': 15.8569, 'rougeLsum': 25.2783}, 'ppl': {'perplexity': 8.719, 'ref_perplexity': 15.1282}, 'bertscore': {'precision': 84.4356, 'recall': 84.7966, 'f1': 84.6085}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 2
Start Training!
Sample 6523 of the training set: {'input_ids': [0, 21714, 1215, 4718, 4563, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 20920, 6, 38, 437, 259, 7, 192, 427, 4, 2812, 459, 1264, 4, 1437, 50118, 10431, 41761, 176, 10431, 35, 5143, 42, 169, 6, 21958, 4, 1437, 50118, 10431, 41761, 246, 10431, 35, 6127, 328, 653, 64, 38, 109, 13, 47, 116, 1437, 50118, 10431, 41761, 176, 10431, 35, 427, 4, 2812, 462, 1264, 6, 38, 437, 269, 6661, 7, 3605, 47, 6, 53, 38, 240, 110, 244, 4, 1437, 50118, 10431, 41761, 246, 10431, 35, 21893, 13, 47, 6, 6127, 328, 2486, 1150, 21, 101, 10, 2138, 7, 162, 4, 1437, 50118, 10431, 41761, 176, 10431, 35, 2647, 6, 21958, 6, 47, 192, 6, 42, 7306, 34, 478, 162, 1256, 543, 4, 38, 685, 127, 633, 8, 38, 437, 11, 10, 319, 9, 1126, 4, 1437, 50118, 10431, 41761, 246, 10431, 35, 38, 192, 4, 479, 479, 479, 479, 479, 1437, 50118, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.5583, 'rouge2': 6.2009, 'rougeL': 17.8544, 'rougeLsum': 25.9036}, 'ppl': {'perplexity': 13.5627, 'ref_perplexity': 27.4807}, 'bertscore': {'precision': 83.8575, 'recall': 84.2487, 'f1': 84.0428}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 28.2461, 'rouge2': 5.0896, 'rougeL': 17.4882, 'rougeLsum': 27.275}, 'ppl': {'perplexity': 1.7804, 'ref_perplexity': 19.8376}, 'bertscore': {'precision': 86.4782, 'recall': 84.5363, 'f1': 85.4931}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.6155, 'rouge2': 4.459, 'rougeL': 17.733, 'rougeLsum': 26.7535}, 'ppl': {'perplexity': 2.5114, 'ref_perplexity': 16.7309}, 'bertscore': {'precision': 85.5012, 'recall': 84.9092, 'f1': 85.201}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.8287, 'rouge2': 4.2059, 'rougeL': 17.0059, 'rougeLsum': 26.1342}, 'ppl': {'perplexity': 2.0882, 'ref_perplexity': 14.8029}, 'bertscore': {'precision': 85.3409, 'recall': 85.0279, 'f1': 85.1807}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.8745, 'rouge2': 5.2274, 'rougeL': 17.4867, 'rougeLsum': 26.0621}, 'ppl': {'perplexity': 5.4006, 'ref_perplexity': 13.7329}, 'bertscore': {'precision': 85.9797, 'recall': 84.9366, 'f1': 85.4513}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1917, 'rouge2': 4.2375, 'rougeL': 15.4639, 'rougeLsum': 24.4134}, 'ppl': {'perplexity': 8.2362, 'ref_perplexity': 13.0613}, 'bertscore': {'precision': 84.2622, 'recall': 84.8462, 'f1': 84.5462}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3592, 'rouge2': 4.3558, 'rougeL': 15.801, 'rougeLsum': 24.6968}, 'ppl': {'perplexity': 6.1535, 'ref_perplexity': 12.6903}, 'bertscore': {'precision': 84.7941, 'recall': 84.8905, 'f1': 84.8364}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.579, 'rouge2': 4.3899, 'rougeL': 15.8501, 'rougeLsum': 25.7502}, 'ppl': {'perplexity': 12.1234, 'ref_perplexity': 12.5234}, 'bertscore': {'precision': 84.2731, 'recall': 85.0299, 'f1': 84.6439}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7257, 'rouge2': 4.5164, 'rougeL': 15.8949, 'rougeLsum': 25.1239}, 'ppl': {'perplexity': 12.0366, 'ref_perplexity': 12.4462}, 'bertscore': {'precision': 84.3293, 'recall': 84.8729, 'f1': 84.592}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.2164, 'rouge2': 4.2431, 'rougeL': 15.9827, 'rougeLsum': 25.4739}, 'ppl': {'perplexity': 14.5699, 'ref_perplexity': 12.5515}, 'bertscore': {'precision': 84.252, 'recall': 84.9159, 'f1': 84.5761}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1091, 'rouge2': 3.9101, 'rougeL': 15.3402, 'rougeLsum': 24.3774}, 'ppl': {'perplexity': 10.6086, 'ref_perplexity': 12.7344}, 'bertscore': {'precision': 84.068, 'recall': 84.8435, 'f1': 84.4455}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.3635, 'rouge2': 4.1932, 'rougeL': 15.8462, 'rougeLsum': 25.5592}, 'ppl': {'perplexity': 18.2179, 'ref_perplexity': 12.8991}, 'bertscore': {'precision': 84.1828, 'recall': 84.8345, 'f1': 84.5005}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.5086, 'rouge2': 3.3728, 'rougeL': 15.1382, 'rougeLsum': 23.7779}, 'ppl': {'perplexity': 19.9257, 'ref_perplexity': 13.0902}, 'bertscore': {'precision': 84.3304, 'recall': 84.8634, 'f1': 84.5897}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6583, 'rouge2': 3.8483, 'rougeL': 15.7155, 'rougeLsum': 24.9319}, 'ppl': {'perplexity': 7.7447, 'ref_perplexity': 13.4352}, 'bertscore': {'precision': 84.3357, 'recall': 84.8184, 'f1': 84.5691}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3882, 'rouge2': 3.768, 'rougeL': 15.544, 'rougeLsum': 24.6197}, 'ppl': {'perplexity': 8.7213, 'ref_perplexity': 13.5725}, 'bertscore': {'precision': 84.5229, 'recall': 84.8602, 'f1': 84.684}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3529, 'rouge2': 3.6822, 'rougeL': 15.4774, 'rougeLsum': 24.5552}, 'ppl': {'perplexity': 11.2978, 'ref_perplexity': 13.9112}, 'bertscore': {'precision': 84.3454, 'recall': 84.8484, 'f1': 84.5883}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.8831, 'rouge2': 3.4947, 'rougeL': 15.206, 'rougeLsum': 24.1268}, 'ppl': {'perplexity': 9.5028, 'ref_perplexity': 14.1059}, 'bertscore': {'precision': 84.268, 'recall': 84.79, 'f1': 84.5201}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.0929, 'rouge2': 3.5203, 'rougeL': 15.3575, 'rougeLsum': 24.3029}, 'ppl': {'perplexity': 7.0629, 'ref_perplexity': 14.3365}, 'bertscore': {'precision': 84.2879, 'recall': 84.8194, 'f1': 84.5447}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1706, 'rouge2': 3.5396, 'rougeL': 15.3836, 'rougeLsum': 24.3644}, 'ppl': {'perplexity': 9.1514, 'ref_perplexity': 14.4873}, 'bertscore': {'precision': 84.3108, 'recall': 84.822, 'f1': 84.5584}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2269, 'rouge2': 3.5185, 'rougeL': 15.3286, 'rougeLsum': 24.3818}, 'ppl': {'perplexity': 1354.0564, 'ref_perplexity': 14.5298}, 'bertscore': {'precision': 84.2867, 'recall': 84.8321, 'f1': 84.5511}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 3
Start Training!
Sample 10905 of the training set: {'input_ids': [0, 21714, 1215, 1092, 27761, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 1336, 109, 47, 120, 552, 19, 110, 3504, 116, 50118, 10431, 41761, 176, 10431, 35, 38, 56, 10, 14353, 447, 1291, 19, 127, 3504, 6, 190, 600, 52, 32, 182, 430, 82, 4, 3047, 38, 348, 56, 10, 346, 9, 14063, 6, 38, 348, 283, 7, 4883, 14, 7, 146, 383, 173, 6, 47, 33, 7, 1346, 99, 18, 505, 7, 110, 3504, 4, 1892, 47, 33, 7, 109, 960, 47, 64, 7, 323, 123, 36, 50, 69, 32801, 85, 18, 1632, 7, 206, 59, 110, 308, 4026, 78, 6, 53, 114, 47, 244, 110, 3504, 6, 318, 29, 533, 7, 517, 110, 4026, 789, 23, 5, 276, 86, 4, 1308, 94, 3504, 21, 372, 11, 14, 6203, 6, 79, 10874, 127, 1170, 8, 14986, 162, 77, 38, 1147, 69, 11829, 69, 1175, 4, 50118, 10431, 41761, 134, 10431, 35, 653, 109, 47, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.3049, 'rouge2': 5.5474, 'rougeL': 16.9934, 'rougeLsum': 26.3738}, 'ppl': {'perplexity': 11.4506, 'ref_perplexity': 27.2963}, 'bertscore': {'precision': 83.1269, 'recall': 84.1068, 'f1': 83.6084}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 29.0977, 'rouge2': 5.5708, 'rougeL': 18.2302, 'rougeLsum': 28.11}, 'ppl': {'perplexity': 5.4155, 'ref_perplexity': 19.8205}, 'bertscore': {'precision': 85.8556, 'recall': 84.704, 'f1': 85.2731}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.4125, 'rouge2': 3.9713, 'rougeL': 17.0645, 'rougeLsum': 25.2535}, 'ppl': {'perplexity': 1.8986, 'ref_perplexity': 16.539}, 'bertscore': {'precision': 84.9795, 'recall': 84.9034, 'f1': 84.9379}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.4256, 'rouge2': 4.4049, 'rougeL': 16.1647, 'rougeLsum': 25.6169}, 'ppl': {'perplexity': 7.7116, 'ref_perplexity': 14.8644}, 'bertscore': {'precision': 83.5949, 'recall': 84.677, 'f1': 84.1264}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
Parameter 'function'=<function get_datasets.<locals>.preprocess_function at 0x711a9ab73430> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 3
Start Training!
Sample 9056 of the training set: {'input_ids': [0, 21714, 1215, 698, 29187, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 20, 983, 18, 1747, 259, 328, 50118, 10431, 41761, 176, 10431, 35, 178, 24, 18, 10, 251, 65, 4, 38, 33, 302, 160, 4, 85, 18, 4604, 1053, 50, 402, 101, 14, 4, 50118, 10431, 41761, 134, 10431, 35, 33597, 4, 85, 18, 5, 15806, 9, 5, 18906, 191, 4, 166, 214, 4036, 7, 10, 20212, 537, 11, 5, 2221, 3859, 4, 50118, 10431, 41761, 176, 10431, 35, 24661, 205, 4, 653, 109, 52, 240, 7, 836, 116, 50118, 10431, 41761, 134, 10431, 35, 166, 240, 7, 907, 103, 741, 12140, 13, 5, 2131, 3678, 8, 31599, 7150, 268, 6, 8, 38, 437, 442, 17284, 13153, 4, 50118, 10431, 41761, 176, 10431, 35, 38, 581, 8512, 66, 5, 4967, 354, 14650, 8, 127, 449, 1459, 31, 6951, 4, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.2464, 'rouge2': 5.8075, 'rougeL': 17.5432, 'rougeLsum': 26.5778}, 'ppl': {'perplexity': 4.9539, 'ref_perplexity': 26.9419}, 'bertscore': {'precision': 84.3489, 'recall': 84.6749, 'f1': 84.508}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 29.2385, 'rouge2': 4.5301, 'rougeL': 17.9741, 'rougeLsum': 28.4691}, 'ppl': {'perplexity': 3.3527, 'ref_perplexity': 19.4192}, 'bertscore': {'precision': 85.4608, 'recall': 84.2852, 'f1': 84.8658}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6834, 'rouge2': 3.5389, 'rougeL': 16.819, 'rougeLsum': 24.9191}, 'ppl': {'perplexity': 3.0512, 'ref_perplexity': 16.4323}, 'bertscore': {'precision': 84.9951, 'recall': 84.7206, 'f1': 84.854}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2944, 'rouge2': 3.4698, 'rougeL': 15.4765, 'rougeLsum': 24.455}, 'ppl': {'perplexity': 3.2098, 'ref_perplexity': 14.631}, 'bertscore': {'precision': 83.946, 'recall': 84.4924, 'f1': 84.2129}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.6991, 'rouge2': 4.7951, 'rougeL': 16.5569, 'rougeLsum': 26.0413}, 'ppl': {'perplexity': 8.6734, 'ref_perplexity': 13.6723}, 'bertscore': {'precision': 84.3522, 'recall': 85.0035, 'f1': 84.6722}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2109, 'rouge2': 4.1117, 'rougeL': 16.1189, 'rougeLsum': 24.5146}, 'ppl': {'perplexity': 4.703, 'ref_perplexity': 13.0514}, 'bertscore': {'precision': 84.9936, 'recall': 84.7803, 'f1': 84.8811}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.5293, 'rouge2': 4.3138, 'rougeL': 16.3829, 'rougeLsum': 25.7204}, 'ppl': {'perplexity': 6.3064, 'ref_perplexity': 12.7223}, 'bertscore': {'precision': 85.0418, 'recall': 84.9634, 'f1': 84.9957}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.5935, 'rouge2': 4.2722, 'rougeL': 16.5136, 'rougeLsum': 25.8011}, 'ppl': {'perplexity': 8.6723, 'ref_perplexity': 12.5294}, 'bertscore': {'precision': 85.1353, 'recall': 84.9827, 'f1': 85.0539}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.4113, 'rouge2': 4.0385, 'rougeL': 16.0384, 'rougeLsum': 25.6555}, 'ppl': {'perplexity': 9.2126, 'ref_perplexity': 12.5291}, 'bertscore': {'precision': 84.5765, 'recall': 84.9567, 'f1': 84.7598}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.9871, 'rouge2': 3.8757, 'rougeL': 15.2599, 'rougeLsum': 24.2658}, 'ppl': {'perplexity': 15.0314, 'ref_perplexity': 12.6069}, 'bertscore': {'precision': 84.062, 'recall': 84.8058, 'f1': 84.4257}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.538, 'rouge2': 3.989, 'rougeL': 15.5363, 'rougeLsum': 25.7767}, 'ppl': {'perplexity': 14.5935, 'ref_perplexity': 12.7989}, 'bertscore': {'precision': 83.8786, 'recall': 84.8291, 'f1': 84.3451}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0537, 'rouge2': 3.6922, 'rougeL': 15.732, 'rougeLsum': 25.2378}, 'ppl': {'perplexity': 6.5576, 'ref_perplexity': 13.0188}, 'bertscore': {'precision': 84.5815, 'recall': 84.8654, 'f1': 84.7158}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.0177, 'rouge2': 3.4604, 'rougeL': 15.2171, 'rougeLsum': 24.215}, 'ppl': {'perplexity': 8.4567, 'ref_perplexity': 13.3552}, 'bertscore': {'precision': 84.065, 'recall': 84.774, 'f1': 84.4091}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6695, 'rouge2': 3.5559, 'rougeL': 15.4651, 'rougeLsum': 24.884}, 'ppl': {'perplexity': 20.0615, 'ref_perplexity': 13.6675}, 'bertscore': {'precision': 84.2742, 'recall': 84.8256, 'f1': 84.5421}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.8023, 'rouge2': 3.6232, 'rougeL': 15.4358, 'rougeLsum': 24.9356}, 'ppl': {'perplexity': 17.3648, 'ref_perplexity': 13.9671}, 'bertscore': {'precision': 84.1821, 'recall': 84.8181, 'f1': 84.4917}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4047, 'rouge2': 3.394, 'rougeL': 15.3189, 'rougeLsum': 24.5239}, 'ppl': {'perplexity': 13.0061, 'ref_perplexity': 14.3435}, 'bertscore': {'precision': 84.2705, 'recall': 84.8155, 'f1': 84.5349}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0689, 'rouge2': 3.6703, 'rougeL': 15.6171, 'rougeLsum': 25.2802}, 'ppl': {'perplexity': 10.8669, 'ref_perplexity': 14.5919}, 'bertscore': {'precision': 84.3108, 'recall': 84.8596, 'f1': 84.5771}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.8205, 'rouge2': 3.5745, 'rougeL': 15.3634, 'rougeLsum': 24.9924}, 'ppl': {'perplexity': 57.6996, 'ref_perplexity': 14.7825}, 'bertscore': {'precision': 84.0276, 'recall': 84.8242, 'f1': 84.417}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.9498, 'rouge2': 3.6247, 'rougeL': 15.4614, 'rougeLsum': 25.0898}, 'ppl': {'perplexity': 10.3098, 'ref_perplexity': 14.9286}, 'bertscore': {'precision': 84.2532, 'recall': 84.8592, 'f1': 84.548}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.9137, 'rouge2': 3.6301, 'rougeL': 15.4647, 'rougeLsum': 25.0571}, 'ppl': {'perplexity': 10.4656, 'ref_perplexity': 15.0416}, 'bertscore': {'precision': 84.3075, 'recall': 84.8575, 'f1': 84.5741}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 4
Start Training!
Sample 2577 of the training set: {'input_ids': [0, 21714, 1215, 1244, 4718, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 5534, 6, 117, 4, 166, 214, 164, 7, 28, 628, 13, 5, 529, 4, 1437, 50118, 10431, 41761, 176, 10431, 35, 440, 4, 166, 581, 120, 10, 11148, 4, 85, 18, 3845, 87, 602, 5, 2353, 50, 5, 15604, 4, 1437, 50118, 10431, 41761, 134, 10431, 35, 5534, 6, 205, 4, 1336, 203, 40, 24, 701, 116, 1437, 50118, 10431, 41761, 176, 10431, 35, 2647, 6, 740, 10155, 32, 55, 3214, 87, 5, 2353, 50, 5, 15604, 4, 85, 581, 1153, 701, 198, 411, 1932, 4, 34419, 328, 27785, 27785, 1437, 50118, 10431, 41761, 134, 10431, 35, 38, 64, 75, 465, 5, 265, 1886, 4, 1832, 47, 216, 5, 1100, 116, 1437, 50118, 10431, 41761, 176, 10431, 35, 8976, 4, 38, 1145, 19, 106, 124, 11, 494, 6, 2145, 116, 1437, 50118, 10431, 41761, 134, 10431, 35, 5143, 4, 1437, 50118, 10431, 41761, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 30.3432, 'rouge2': 5.9392, 'rougeL': 18.3896, 'rougeLsum': 28.7574}, 'ppl': {'perplexity': 8.5543, 'ref_perplexity': 26.3436}, 'bertscore': {'precision': 83.1734, 'recall': 84.2584, 'f1': 83.7081}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1478, 'rouge2': 4.032, 'rougeL': 16.4856, 'rougeLsum': 24.398}, 'ppl': {'perplexity': 3.1478, 'ref_perplexity': 19.0832}, 'bertscore': {'precision': 84.0151, 'recall': 84.7312, 'f1': 84.3656}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 28.3392, 'rouge2': 5.7222, 'rougeL': 17.732, 'rougeLsum': 27.5724}, 'ppl': {'perplexity': 3.0417, 'ref_perplexity': 16.1721}, 'bertscore': {'precision': 85.1966, 'recall': 84.796, 'f1': 84.9918}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.5489, 'rouge2': 5.6418, 'rougeL': 17.5889, 'rougeLsum': 26.9453}, 'ppl': {'perplexity': 2.2597, 'ref_perplexity': 14.48}, 'bertscore': {'precision': 86.4074, 'recall': 84.9213, 'f1': 85.6553}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.3986, 'rouge2': 4.8274, 'rougeL': 16.9289, 'rougeLsum': 25.6215}, 'ppl': {'perplexity': 3.543, 'ref_perplexity': 13.4921}, 'bertscore': {'precision': 85.524, 'recall': 85.0937, 'f1': 85.3038}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.1148, 'rouge2': 4.7952, 'rougeL': 16.1288, 'rougeLsum': 25.436}, 'ppl': {'perplexity': 10.6937, 'ref_perplexity': 12.8234}, 'bertscore': {'precision': 84.1343, 'recall': 85.0345, 'f1': 84.5778}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 23.9105, 'rouge2': 3.4264, 'rougeL': 15.6089, 'rougeLsum': 23.289}, 'ppl': {'perplexity': 4.3573, 'ref_perplexity': 12.5574}, 'bertscore': {'precision': 85.17, 'recall': 84.929, 'f1': 85.0432}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.482, 'rouge2': 3.3191, 'rougeL': 15.7574, 'rougeLsum': 23.6851}, 'ppl': {'perplexity': 6.7929, 'ref_perplexity': 12.4503}, 'bertscore': {'precision': 85.615, 'recall': 84.9721, 'f1': 85.2875}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.2224, 'rouge2': 4.4256, 'rougeL': 15.7608, 'rougeLsum': 25.4691}, 'ppl': {'perplexity': 14.72, 'ref_perplexity': 12.3559}, 'bertscore': {'precision': 84.4526, 'recall': 84.9233, 'f1': 84.6817}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.668, 'rouge2': 3.7927, 'rougeL': 15.9507, 'rougeLsum': 24.9037}, 'ppl': {'perplexity': 6.389, 'ref_perplexity': 12.4548}, 'bertscore': {'precision': 84.5114, 'recall': 84.9303, 'f1': 84.7141}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.5091, 'rouge2': 3.4051, 'rougeL': 15.275, 'rougeLsum': 23.7184}, 'ppl': {'perplexity': 7.8397, 'ref_perplexity': 12.6806}, 'bertscore': {'precision': 84.3383, 'recall': 84.8623, 'f1': 84.5923}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.492, 'rouge2': 3.4925, 'rougeL': 15.3085, 'rougeLsum': 23.6894}, 'ppl': {'perplexity': 7.9036, 'ref_perplexity': 12.8529}, 'bertscore': {'precision': 84.595, 'recall': 84.848, 'f1': 84.7129}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3975, 'rouge2': 3.8551, 'rougeL': 15.6935, 'rougeLsum': 24.6505}, 'ppl': {'perplexity': 9.7886, 'ref_perplexity': 13.1776}, 'bertscore': {'precision': 84.717, 'recall': 84.938, 'f1': 84.82}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.9394, 'rouge2': 3.6941, 'rougeL': 15.5497, 'rougeLsum': 24.1782}, 'ppl': {'perplexity': 10.9074, 'ref_perplexity': 13.4021}, 'bertscore': {'precision': 84.5301, 'recall': 84.9104, 'f1': 84.7123}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4074, 'rouge2': 3.4224, 'rougeL': 15.4445, 'rougeLsum': 24.5192}, 'ppl': {'perplexity': 17.3035, 'ref_perplexity': 13.7147}, 'bertscore': {'precision': 84.2971, 'recall': 84.8401, 'f1': 84.5599}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.7135, 'rouge2': 3.515, 'rougeL': 15.3882, 'rougeLsum': 23.8942}, 'ppl': {'perplexity': 8.2393, 'ref_perplexity': 13.9896}, 'bertscore': {'precision': 84.8251, 'recall': 84.8963, 'f1': 84.853}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2358, 'rouge2': 3.56, 'rougeL': 15.447, 'rougeLsum': 24.399}, 'ppl': {'perplexity': 7.5804, 'ref_perplexity': 14.2419}, 'bertscore': {'precision': 84.5474, 'recall': 84.8939, 'f1': 84.7124}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2424, 'rouge2': 3.4967, 'rougeL': 15.3653, 'rougeLsum': 24.3956}, 'ppl': {'perplexity': 18.8555, 'ref_perplexity': 14.4826}, 'bertscore': {'precision': 84.3349, 'recall': 84.8451, 'f1': 84.5812}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2423, 'rouge2': 3.5706, 'rougeL': 15.4789, 'rougeLsum': 24.3863}, 'ppl': {'perplexity': 10.4569, 'ref_perplexity': 14.6188}, 'bertscore': {'precision': 84.4899, 'recall': 84.8673, 'f1': 84.6706}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4914, 'rouge2': 3.6463, 'rougeL': 15.4859, 'rougeLsum': 24.6435}, 'ppl': {'perplexity': 15.4155, 'ref_perplexity': 14.6955}, 'bertscore': {'precision': 84.4804, 'recall': 84.8648, 'f1': 84.6641}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 5
Start Training!
Sample 7038 of the training set: {'input_ids': [0, 21714, 1215, 398, 32769, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 38, 679, 14, 47, 373, 162, 116, 50118, 10431, 41761, 176, 10431, 35, 5534, 6, 20280, 4, 4557, 13, 562, 124, 7, 162, 1335, 4, 50118, 10431, 41761, 134, 10431, 35, 2612, 222, 47, 486, 162, 116, 50118, 10431, 41761, 176, 10431, 35, 38, 21, 1765, 59, 110, 979, 4, 50118, 10431, 41761, 134, 10431, 35, 6553, 37, 109, 402, 1593, 116, 50118, 10431, 41761, 176, 10431, 35, 2486, 979, 21, 3501, 62, 11, 1380, 4, 50118, 10431, 41761, 134, 10431, 35, 653, 109, 47, 1266, 116, 50118, 10431, 41761, 176, 10431, 35, 91, 21, 1686, 8, 3735, 10, 20771, 148, 1380, 4, 50118, 10431, 41761, 134, 10431, 35, 280, 18, 269, 45, 101, 123, 4, 50118, 10431, 41761, 176, 10431, 35, 318, 47, 115, 95, 1067, 7, 123, 6, 38, 74, 8908, 5478, 24, 4, 50118, 10431, 41761, 134, 10431, 35, 38, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.5327, 'rouge2': 5.5563, 'rougeL': 17.8729, 'rougeLsum': 26.6563}, 'ppl': {'perplexity': 17.5014, 'ref_perplexity': 28.3681}, 'bertscore': {'precision': 84.13, 'recall': 84.6777, 'f1': 84.4}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.7507, 'rouge2': 5.5622, 'rougeL': 17.0602, 'rougeLsum': 26.0573}, 'ppl': {'perplexity': 1.6475, 'ref_perplexity': 20.2079}, 'bertscore': {'precision': 85.7367, 'recall': 84.6152, 'f1': 85.1691}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3283, 'rouge2': 3.9263, 'rougeL': 16.8252, 'rougeLsum': 24.592}, 'ppl': {'perplexity': 3.2243, 'ref_perplexity': 16.9876}, 'bertscore': {'precision': 85.1446, 'recall': 84.724, 'f1': 84.9287}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.562, 'rouge2': 3.8342, 'rougeL': 15.7049, 'rougeLsum': 24.7874}, 'ppl': {'perplexity': 22.8914, 'ref_perplexity': 15.1603}, 'bertscore': {'precision': 83.5376, 'recall': 84.6908, 'f1': 84.1058}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.6406, 'rouge2': 4.4565, 'rougeL': 17.0729, 'rougeLsum': 27.0266}, 'ppl': {'perplexity': 3.8937, 'ref_perplexity': 14.0812}, 'bertscore': {'precision': 85.0576, 'recall': 85.003, 'f1': 85.0269}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.4988, 'rouge2': 4.4584, 'rougeL': 16.4408, 'rougeLsum': 25.6925}, 'ppl': {'perplexity': 5.4452, 'ref_perplexity': 13.4038}, 'bertscore': {'precision': 84.924, 'recall': 84.9256, 'f1': 84.9179}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7439, 'rouge2': 3.919, 'rougeL': 16.2418, 'rougeLsum': 25.0765}, 'ppl': {'perplexity': 3.202, 'ref_perplexity': 13.0542}, 'bertscore': {'precision': 84.87, 'recall': 84.7093, 'f1': 84.7839}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.1837, 'rouge2': 4.4729, 'rougeL': 16.4841, 'rougeLsum': 26.4675}, 'ppl': {'perplexity': 5.4522, 'ref_perplexity': 12.7737}, 'bertscore': {'precision': 84.5606, 'recall': 84.8286, 'f1': 84.6898}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.7506, 'rouge2': 3.7228, 'rougeL': 15.2274, 'rougeLsum': 24.0477}, 'ppl': {'perplexity': 7.5782, 'ref_perplexity': 12.7479}, 'bertscore': {'precision': 84.137, 'recall': 84.6848, 'f1': 84.4049}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.1052, 'rouge2': 3.5897, 'rougeL': 14.784, 'rougeLsum': 23.451}, 'ppl': {'perplexity': 10.7497, 'ref_perplexity': 12.8406}, 'bertscore': {'precision': 84.1071, 'recall': 84.7681, 'f1': 84.4292}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.4054, 'rouge2': 3.3477, 'rougeL': 15.1367, 'rougeLsum': 23.5822}, 'ppl': {'perplexity': 12.4114, 'ref_perplexity': 12.9306}, 'bertscore': {'precision': 84.5838, 'recall': 84.8115, 'f1': 84.691}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.9555, 'rouge2': 3.5427, 'rougeL': 15.1778, 'rougeLsum': 24.1733}, 'ppl': {'perplexity': 9.3261, 'ref_perplexity': 13.1423}, 'bertscore': {'precision': 83.8382, 'recall': 84.7956, 'f1': 84.307}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3858, 'rouge2': 3.8237, 'rougeL': 15.494, 'rougeLsum': 24.5832}, 'ppl': {'perplexity': 12.6987, 'ref_perplexity': 13.3375}, 'bertscore': {'precision': 84.2539, 'recall': 84.7835, 'f1': 84.5093}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.962, 'rouge2': 3.8879, 'rougeL': 15.5619, 'rougeLsum': 25.116}, 'ppl': {'perplexity': 13.248, 'ref_perplexity': 13.7022}, 'bertscore': {'precision': 84.1202, 'recall': 84.8048, 'f1': 84.4532}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.9245, 'rouge2': 3.879, 'rougeL': 15.6011, 'rougeLsum': 25.1233}, 'ppl': {'perplexity': 640.1918, 'ref_perplexity': 13.9978}, 'bertscore': {'precision': 84.0622, 'recall': 84.8406, 'f1': 84.4426}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4371, 'rouge2': 3.589, 'rougeL': 15.1833, 'rougeLsum': 24.6267}, 'ppl': {'perplexity': 18.3266, 'ref_perplexity': 14.2174}, 'bertscore': {'precision': 83.7249, 'recall': 84.739, 'f1': 84.2209}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1642, 'rouge2': 3.4992, 'rougeL': 15.1725, 'rougeLsum': 24.3613}, 'ppl': {'perplexity': 13.6121, 'ref_perplexity': 14.4609}, 'bertscore': {'precision': 83.9625, 'recall': 84.7623, 'f1': 84.3528}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.5681, 'rouge2': 3.5439, 'rougeL': 15.3885, 'rougeLsum': 24.7111}, 'ppl': {'perplexity': 11.4197, 'ref_perplexity': 14.6488}, 'bertscore': {'precision': 83.9583, 'recall': 84.7882, 'f1': 84.3637}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4836, 'rouge2': 3.5611, 'rougeL': 15.2229, 'rougeLsum': 24.608}, 'ppl': {'perplexity': 17.0013, 'ref_perplexity': 14.8404}, 'bertscore': {'precision': 83.9441, 'recall': 84.7869, 'f1': 84.3554}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Parameter 'function'=<function get_datasets.<locals>.preprocess_function at 0x7a05e4df4430> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
Using default tokenizer.
{'rouge': {'rouge1': 25.549, 'rouge2': 3.5595, 'rougeL': 15.2968, 'rougeLsum': 24.675}, 'ppl': {'perplexity': 47.7383, 'ref_perplexity': 14.9123}, 'bertscore': {'precision': 83.9336, 'recall': 84.7831, 'f1': 84.3487}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 6
Start Training!
Sample 4088 of the training set: {'input_ids': [0, 21714, 1215, 1749, 4652, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 4954, 6, 17264, 6, 38, 348, 57, 2057, 15, 10, 367, 2697, 8, 47, 214, 1341, 10, 11257, 2564, 2173, 4, 50118, 10431, 41761, 176, 10431, 35, 2647, 6, 3392, 47, 4, 50118, 10431, 41761, 134, 10431, 35, 653, 109, 47, 5940, 116, 653, 64, 38, 109, 7, 2217, 2408, 116, 50118, 10431, 41761, 176, 10431, 35, 2647, 6, 38, 3325, 10, 319, 4, 38, 213, 878, 23, 513, 130, 498, 10, 186, 4, 125, 55, 87, 14, 38, 2254, 816, 1612, 8, 98, 430, 1612, 304, 430, 14357, 8, 70, 9, 24, 2607, 7, 2217, 14, 2408, 14, 47, 429, 33, 3491, 4, 50118, 10431, 41761, 134, 10431, 35, 8976, 6, 157, 6, 888, 6, 65, 9, 5, 1272, 16, 14, 38, 888, 3325, 10, 319, 4, 50118, 10431, 41761, 176, 10431, 35, 1832, 13531, 116, 50118, 10431, 41761, 134, 10431, 35, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 28.1878, 'rouge2': 5.7735, 'rougeL': 17.4442, 'rougeLsum': 27.2666}, 'ppl': {'perplexity': 1.4589, 'ref_perplexity': 27.5687}, 'bertscore': {'precision': 83.8059, 'recall': 83.9648, 'f1': 83.8832}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.9886, 'rouge2': 3.9787, 'rougeL': 16.6557, 'rougeLsum': 24.3125}, 'ppl': {'perplexity': 3.084, 'ref_perplexity': 19.6767}, 'bertscore': {'precision': 85.0425, 'recall': 84.0088, 'f1': 84.5188}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3988, 'rouge2': 3.8828, 'rougeL': 17.013, 'rougeLsum': 24.5612}, 'ppl': {'perplexity': 1.984, 'ref_perplexity': 16.676}, 'bertscore': {'precision': 86.1709, 'recall': 84.846, 'f1': 85.4991}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.8374, 'rouge2': 3.6872, 'rougeL': 16.4764, 'rougeLsum': 25.0567}, 'ppl': {'perplexity': 2.4871, 'ref_perplexity': 14.8417}, 'bertscore': {'precision': 85.913, 'recall': 84.4428, 'f1': 85.1665}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.2695, 'rouge2': 4.1035, 'rougeL': 16.8419, 'rougeLsum': 25.4492}, 'ppl': {'perplexity': 5.4199, 'ref_perplexity': 13.8385}, 'bertscore': {'precision': 85.1096, 'recall': 84.8, 'f1': 84.9497}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.679, 'rouge2': 4.5654, 'rougeL': 15.7928, 'rougeLsum': 25.0193}, 'ppl': {'perplexity': 13.3503, 'ref_perplexity': 13.2342}, 'bertscore': {'precision': 84.16, 'recall': 84.8162, 'f1': 84.4786}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 24.248, 'rouge2': 3.9971, 'rougeL': 15.0795, 'rougeLsum': 23.5639}, 'ppl': {'perplexity': 6.7718, 'ref_perplexity': 12.895}, 'bertscore': {'precision': 84.2782, 'recall': 84.7742, 'f1': 84.519}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.5496, 'rouge2': 4.1505, 'rougeL': 15.9242, 'rougeLsum': 25.7428}, 'ppl': {'perplexity': 13.6519, 'ref_perplexity': 12.7726}, 'bertscore': {'precision': 84.0771, 'recall': 84.9479, 'f1': 84.5047}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.0948, 'rouge2': 3.3075, 'rougeL': 14.8469, 'rougeLsum': 23.4085}, 'ppl': {'perplexity': 12.4305, 'ref_perplexity': 12.7928}, 'bertscore': {'precision': 83.2067, 'recall': 84.7964, 'f1': 83.9881}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 26.0991, 'rouge2': 4.1294, 'rougeL': 15.8532, 'rougeLsum': 25.3723}, 'ppl': {'perplexity': 15.3842, 'ref_perplexity': 12.8345}, 'bertscore': {'precision': 84.1237, 'recall': 84.7827, 'f1': 84.4443}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3579, 'rouge2': 3.7106, 'rougeL': 15.3511, 'rougeLsum': 24.5707}, 'ppl': {'perplexity': 29.5221, 'ref_perplexity': 13.0926}, 'bertscore': {'precision': 83.8079, 'recall': 84.8212, 'f1': 84.3046}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3767, 'rouge2': 3.8488, 'rougeL': 15.3336, 'rougeLsum': 24.5978}, 'ppl': {'perplexity': 14.2229, 'ref_perplexity': 13.3006}, 'bertscore': {'precision': 83.7234, 'recall': 84.8615, 'f1': 84.2817}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.3163, 'rouge2': 3.8054, 'rougeL': 15.2231, 'rougeLsum': 24.5508}, 'ppl': {'perplexity': 21.5125, 'ref_perplexity': 13.6889}, 'bertscore': {'precision': 83.7737, 'recall': 84.8025, 'f1': 84.2773}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.1455, 'rouge2': 3.9299, 'rougeL': 15.508, 'rougeLsum': 25.3678}, 'ppl': {'perplexity': 25.1042, 'ref_perplexity': 14.0249}, 'bertscore': {'precision': 83.7541, 'recall': 84.8623, 'f1': 84.2989}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.464, 'rouge2': 3.5053, 'rougeL': 15.4398, 'rougeLsum': 24.6437}, 'ppl': {'perplexity': 16.2814, 'ref_perplexity': 14.4291}, 'bertscore': {'precision': 83.9678, 'recall': 84.7787, 'f1': 84.364}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 6
Start Training!
Sample 3949 of the training set: {'input_ids': [0, 21714, 1215, 3416, 3414, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 289, 9041, 636, 4, 85, 18, 460, 37, 20069, 4, 125, 141, 21, 110, 2508, 12557, 30097, 116, 50118, 10431, 41761, 176, 10431, 35, 38, 1381, 24, 13, 10, 457, 12, 4509, 4, 85, 21, 2679, 6, 53, 4, 479, 479, 157, 4, 479, 479, 38, 1705, 75, 269, 109, 24, 4, 50118, 10431, 41761, 134, 10431, 35, 4250, 116, 38, 174, 47, 4, 85, 18, 182, 543, 4, 50118, 10431, 41761, 176, 10431, 35, 38, 1705, 75, 190, 1413, 15, 24, 8, 946, 5, 18840, 4, 38, 1153, 1064, 159, 14865, 498, 4, 50118, 10431, 41761, 134, 10431, 35, 22525, 498, 116, 50118, 10431, 41761, 176, 10431, 35, 3216, 6, 24, 21, 269, 12103, 4, 50118, 10431, 41761, 134, 10431, 35, 178, 141, 203, 222, 24, 701, 7, 5956, 24, 116, 50118, 10431, 41761, 176, 10431, 35, 85, 21, 14865, 1932, 13, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
  Total optimization steps = 14020
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.1014, 'rouge2': 3.4418, 'rougeL': 15.1555, 'rougeLsum': 24.2722}, 'ppl': {'perplexity': 17.7822, 'ref_perplexity': 14.6601}, 'bertscore': {'precision': 83.5568, 'recall': 84.7808, 'f1': 84.1574}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.6186, 'rouge2': 5.6338, 'rougeL': 17.4997, 'rougeLsum': 25.844}, 'ppl': {'perplexity': 35.9779, 'ref_perplexity': 38.325}, 'bertscore': {'precision': 84.121, 'recall': 83.9579, 'f1': 84.0288}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.2412, 'rouge2': 3.4524, 'rougeL': 15.1653, 'rougeLsum': 24.3948}, 'ppl': {'perplexity': 11.7937, 'ref_perplexity': 15.0041}, 'bertscore': {'precision': 83.84, 'recall': 84.7689, 'f1': 84.2946}}
Using default tokenizer.
{'rouge': {'rouge1': 24.3622, 'rouge2': 4.7857, 'rougeL': 16.053, 'rougeLsum': 23.6086}, 'ppl': {'perplexity': 26.103, 'ref_perplexity': 24.8797}, 'bertscore': {'precision': 84.3514, 'recall': 84.1333, 'f1': 84.2227}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.8923, 'rouge2': 4.5614, 'rougeL': 17.2127, 'rougeLsum': 24.9725}, 'ppl': {'perplexity': 7.5707, 'ref_perplexity': 20.1338}, 'bertscore': {'precision': 85.219, 'recall': 84.6671, 'f1': 84.9366}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.6718, 'rouge2': 3.5203, 'rougeL': 15.3121, 'rougeLsum': 24.8397}, 'ppl': {'perplexity': 10.3153, 'ref_perplexity': 15.2454}, 'bertscore': {'precision': 83.7875, 'recall': 84.7745, 'f1': 84.2705}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0889, 'rouge2': 4.6466, 'rougeL': 16.8854, 'rougeLsum': 25.3213}, 'ppl': {'perplexity': 6.1754, 'ref_perplexity': 17.7315}, 'bertscore': {'precision': 86.0522, 'recall': 84.7049, 'f1': 85.3676}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.3008, 'rouge2': 3.4342, 'rougeL': 15.1735, 'rougeLsum': 24.4751}, 'ppl': {'perplexity': 11.8141, 'ref_perplexity': 15.4536}, 'bertscore': {'precision': 83.8913, 'recall': 84.7773, 'f1': 84.3239}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3679, 'rouge2': 4.1594, 'rougeL': 16.6495, 'rougeLsum': 24.5778}, 'ppl': {'perplexity': 4.71, 'ref_perplexity': 16.2245}, 'bertscore': {'precision': 85.7311, 'recall': 84.7074, 'f1': 85.2104}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
Using default tokenizer.
{'rouge': {'rouge1': 25.4507, 'rouge2': 3.5062, 'rougeL': 15.2111, 'rougeLsum': 24.6078}, 'ppl': {'perplexity': 13.8022, 'ref_perplexity': 15.5447}, 'bertscore': {'precision': 83.9011, 'recall': 84.7831, 'f1': 84.3321}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
{'rouge': {'rouge1': 26.3484, 'rouge2': 4.6118, 'rougeL': 16.668, 'rougeLsum': 25.5239}, 'ppl': {'perplexity': 5.5273, 'ref_perplexity': 15.1823}, 'bertscore': {'precision': 85.822, 'recall': 84.8376, 'f1': 85.3206}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8




Round 7
Start Training!
Sample 2862 of the training set: {'input_ids': [0, 21714, 1215, 2517, 5379, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 221, 21962, 162, 4, 8901, 110, 2303, 33, 10, 5704, 2122, 116, 50118, 10431, 41761, 176, 10431, 35, 3216, 6, 21958, 4, 166, 860, 7, 9503, 70, 84, 3958, 108, 38356, 6, 217, 5704, 4, 50118, 10431, 41761, 134, 10431, 35, 2860, 328, 4820, 16, 24, 116, 50118, 10431, 41761, 176, 10431, 35, 5348, 6, 5, 6545, 16, 95, 874, 5, 10181, 4, 370, 64, 185, 5, 20276, 50, 5, 16745, 4, 50118, 10431, 41761, 134, 10431, 35, 1832, 38, 33, 7, 582, 1823, 116, 50118, 10431, 41761, 176, 10431, 35, 440, 6, 21958, 4, 85, 18, 20153, 354, 4, 1801, 185, 110, 929, 762, 98, 47, 64, 120, 11, 4, 50118, 10431, 41761, 134, 10431, 35, 653, 32, 5, 6545, 722, 116, 50118, 10431, 41761, 176, 10431, 35, 370, 581, 28, 1372, 7, 216, 14, 24, 18, 490, 706, 73, 406, 4, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
Using default tokenizer.
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
{'rouge': {'rouge1': 25.6468, 'rouge2': 4.3398, 'rougeL': 16.7101, 'rougeLsum': 24.897}, 'ppl': {'perplexity': 8.0445, 'ref_perplexity': 14.512}, 'bertscore': {'precision': 85.6644, 'recall': 84.8763, 'f1': 85.2614}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.6723, 'rouge2': 4.2885, 'rougeL': 16.2542, 'rougeLsum': 24.8939}, 'ppl': {'perplexity': 5.5421, 'ref_perplexity': 14.0498}, 'bertscore': {'precision': 85.2283, 'recall': 84.8617, 'f1': 85.0381}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 27.6337, 'rouge2': 6.2954, 'rougeL': 16.8924, 'rougeLsum': 26.72}, 'ppl': {'perplexity': 22.3691, 'ref_perplexity': 27.7218}, 'bertscore': {'precision': 81.9488, 'recall': 84.191, 'f1': 83.051}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.2867, 'rouge2': 4.3667, 'rougeL': 16.35, 'rougeLsum': 25.5223}, 'ppl': {'perplexity': 8.0438, 'ref_perplexity': 13.8663}, 'bertscore': {'precision': 84.9511, 'recall': 84.8442, 'f1': 84.8914}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 24.4608, 'rouge2': 3.9852, 'rougeL': 15.6839, 'rougeLsum': 23.8918}, 'ppl': {'perplexity': 1.8009, 'ref_perplexity': 19.9842}, 'bertscore': {'precision': 84.6151, 'recall': 83.8733, 'f1': 84.2396}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3935, 'rouge2': 4.1919, 'rougeL': 16.0317, 'rougeLsum': 24.6331}, 'ppl': {'perplexity': 10.7499, 'ref_perplexity': 13.6226}, 'bertscore': {'precision': 85.0336, 'recall': 84.7623, 'f1': 84.8898}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.7607, 'rouge2': 3.8948, 'rougeL': 16.067, 'rougeLsum': 25.0901}, 'ppl': {'perplexity': 5.6697, 'ref_perplexity': 16.7878}, 'bertscore': {'precision': 84.6138, 'recall': 84.3363, 'f1': 84.471}}
Using default tokenizer.
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
{'rouge': {'rouge1': 25.3633, 'rouge2': 3.9467, 'rougeL': 15.9378, 'rougeLsum': 24.6406}, 'ppl': {'perplexity': 7.7275, 'ref_perplexity': 13.594}, 'bertscore': {'precision': 85.1749, 'recall': 84.8003, 'f1': 84.98}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 26.2067, 'rouge2': 4.9612, 'rougeL': 17.1186, 'rougeLsum': 25.552}, 'ppl': {'perplexity': 18.1378, 'ref_perplexity': 14.9978}, 'bertscore': {'precision': 86.2142, 'recall': 84.8723, 'f1': 85.534}}
Using default tokenizer.
{'rouge': {'rouge1': 25.693, 'rouge2': 3.8576, 'rougeL': 15.9752, 'rougeLsum': 24.943}, 'ppl': {'perplexity': 7.3647, 'ref_perplexity': 13.7089}, 'bertscore': {'precision': 84.9095, 'recall': 84.8532, 'f1': 84.8741}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.7092, 'rouge2': 3.8836, 'rougeL': 15.9035, 'rougeLsum': 24.9091}, 'ppl': {'perplexity': 13.4198, 'ref_perplexity': 13.8635}, 'bertscore': {'precision': 84.5453, 'recall': 84.8107, 'f1': 84.6701}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 24.8367, 'rouge2': 4.5055, 'rougeL': 16.0058, 'rougeLsum': 24.1987}, 'ppl': {'perplexity': 5.5945, 'ref_perplexity': 13.9256}, 'bertscore': {'precision': 84.3403, 'recall': 84.769, 'f1': 84.5489}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6998, 'rouge2': 3.7455, 'rougeL': 15.8989, 'rougeLsum': 24.936}, 'ppl': {'perplexity': 12.765, 'ref_perplexity': 14.0012}, 'bertscore': {'precision': 84.6809, 'recall': 84.7722, 'f1': 84.7194}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.2788, 'rouge2': 4.2095, 'rougeL': 16.6562, 'rougeLsum': 24.6082}, 'ppl': {'perplexity': 5.2606, 'ref_perplexity': 13.2322}, 'bertscore': {'precision': 85.7231, 'recall': 84.9573, 'f1': 85.3336}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.9009, 'rouge2': 3.8664, 'rougeL': 16.0003, 'rougeLsum': 25.0734}, 'ppl': {'perplexity': 11.6479, 'ref_perplexity': 14.2997}, 'bertscore': {'precision': 84.7368, 'recall': 84.849, 'f1': 84.7858}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.8962, 'rouge2': 4.6191, 'rougeL': 16.2252, 'rougeLsum': 25.264}, 'ppl': {'perplexity': 14.3796, 'ref_perplexity': 12.842}, 'bertscore': {'precision': 84.0547, 'recall': 84.6852, 'f1': 84.3629}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7839, 'rouge2': 3.6586, 'rougeL': 15.5952, 'rougeLsum': 24.9607}, 'ppl': {'perplexity': 15.7231, 'ref_perplexity': 14.372}, 'bertscore': {'precision': 84.1967, 'recall': 84.7988, 'f1': 84.4888}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 26.3888, 'rouge2': 4.2844, 'rougeL': 16.4288, 'rougeLsum': 25.6479}, 'ppl': {'perplexity': 4.717, 'ref_perplexity': 12.6525}, 'bertscore': {'precision': 84.9842, 'recall': 84.844, 'f1': 84.909}}
Using default tokenizer.
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
{'rouge': {'rouge1': 25.6384, 'rouge2': 3.7064, 'rougeL': 15.5394, 'rougeLsum': 24.8427}, 'ppl': {'perplexity': 21.5887, 'ref_perplexity': 14.4781}, 'bertscore': {'precision': 84.15, 'recall': 84.7727, 'f1': 84.4527}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.4734, 'rouge2': 3.6635, 'rougeL': 15.6937, 'rougeLsum': 24.6512}, 'ppl': {'perplexity': 9.7077, 'ref_perplexity': 14.6766}, 'bertscore': {'precision': 84.3011, 'recall': 84.8112, 'f1': 84.5478}}
Using default tokenizer.
{'rouge': {'rouge1': 25.0821, 'rouge2': 3.999, 'rougeL': 15.5245, 'rougeLsum': 24.3746}, 'ppl': {'perplexity': 5.9287, 'ref_perplexity': 12.6865}, 'bertscore': {'precision': 84.4495, 'recall': 84.8304, 'f1': 84.6328}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7072, 'rouge2': 3.6558, 'rougeL': 15.6872, 'rougeLsum': 24.8852}, 'ppl': {'perplexity': 15.8932, 'ref_perplexity': 14.7817}, 'bertscore': {'precision': 84.1486, 'recall': 84.7666, 'f1': 84.4484}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.6294, 'rouge2': 4.0984, 'rougeL': 15.792, 'rougeLsum': 24.8493}, 'ppl': {'perplexity': 6.6341, 'ref_perplexity': 12.778}, 'bertscore': {'precision': 84.2553, 'recall': 84.8312, 'f1': 84.5353}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7889, 'rouge2': 3.7327, 'rougeL': 15.6463, 'rougeLsum': 24.9317}, 'ppl': {'perplexity': 11.8301, 'ref_perplexity': 14.8336}, 'bertscore': {'precision': 84.2965, 'recall': 84.7859, 'f1': 84.5323}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.0768, 'rouge2': 3.7572, 'rougeL': 15.2683, 'rougeLsum': 24.4348}, 'ppl': {'perplexity': 11.5529, 'ref_perplexity': 13.1005}, 'bertscore': {'precision': 84.1685, 'recall': 84.8137, 'f1': 84.4812}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.126, 'rouge2': 3.9708, 'rougeL': 15.7582, 'rougeLsum': 25.3254}, 'ppl': {'perplexity': 6.3212, 'ref_perplexity': 13.2743}, 'bertscore': {'precision': 84.4257, 'recall': 84.8462, 'f1': 84.6286}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 7
Start Training!
Sample 1045 of the training set: {'input_ids': [0, 21714, 1215, 698, 1898, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 24953, 15, 3433, 5, 2189, 23, 5, 485, 4365, 6, 4523, 1628, 328, 50118, 10431, 41761, 176, 10431, 35, 3837, 47, 6, 427, 4, 248, 3994, 254, 4, 50118, 10431, 41761, 134, 10431, 35, 5534, 6, 356, 23, 167, 18637, 328, 370, 1059, 10, 7358, 999, 23, 5, 1046, 9, 23843, 6, 399, 75, 47, 116, 50118, 10431, 41761, 176, 10431, 35, 8976, 6, 47, 214, 235, 4, 50118, 10431, 41761, 134, 10431, 35, 9918, 47, 1137, 162, 402, 59, 110, 708, 13, 5, 499, 116, 50118, 10431, 41761, 176, 10431, 35, 598, 1137, 47, 5, 3157, 6, 38, 437, 164, 7, 492, 62, 7358, 31, 122, 15, 4, 50118, 10431, 41761, 134, 10431, 35, 38, 21422, 110, 19074, 116, 50118, 10431, 41761, 176, 10431, 35, 38, 1266, 38, 1017, 1195, 45, 6966, 23, 70, 4, 38, 437, 350, 793, 7, 734, 50118, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
  Total optimization steps = 14020
Using default tokenizer.
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
{'rouge': {'rouge1': 25.3398, 'rouge2': 3.7286, 'rougeL': 15.4757, 'rougeLsum': 24.5911}, 'ppl': {'perplexity': 12.1447, 'ref_perplexity': 13.5746}, 'bertscore': {'precision': 84.2457, 'recall': 84.8233, 'f1': 84.5263}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 28.1866, 'rouge2': 6.5126, 'rougeL': 18.0097, 'rougeLsum': 27.4597}, 'ppl': {'perplexity': 37.2895, 'ref_perplexity': 38.9042}, 'bertscore': {'precision': 82.5866, 'recall': 83.7275, 'f1': 83.1435}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.6657, 'rouge2': 3.6157, 'rougeL': 15.3715, 'rougeLsum': 24.8547}, 'ppl': {'perplexity': 10.4134, 'ref_perplexity': 13.8507}, 'bertscore': {'precision': 83.991, 'recall': 84.7746, 'f1': 84.3745}}
Using default tokenizer.
{'rouge': {'rouge1': 28.2011, 'rouge2': 5.9459, 'rougeL': 17.7498, 'rougeLsum': 27.2881}, 'ppl': {'perplexity': 18.2951, 'ref_perplexity': 24.8894}, 'bertscore': {'precision': 83.9711, 'recall': 84.3825, 'f1': 84.1677}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.1164, 'rouge2': 5.0734, 'rougeL': 16.9057, 'rougeLsum': 25.389}, 'ppl': {'perplexity': 8.7283, 'ref_perplexity': 20.2}, 'bertscore': {'precision': 85.1051, 'recall': 84.7516, 'f1': 84.92}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.601, 'rouge2': 3.7205, 'rougeL': 15.5212, 'rougeLsum': 24.7547}, 'ppl': {'perplexity': 9.1194, 'ref_perplexity': 14.0916}, 'bertscore': {'precision': 84.415, 'recall': 84.8071, 'f1': 84.6037}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.7897, 'rouge2': 4.7174, 'rougeL': 16.9209, 'rougeLsum': 25.9207}, 'ppl': {'perplexity': 11.1804, 'ref_perplexity': 17.7104}, 'bertscore': {'precision': 85.035, 'recall': 84.6126, 'f1': 84.8165}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.3104, 'rouge2': 3.5058, 'rougeL': 15.0918, 'rougeLsum': 24.4544}, 'ppl': {'perplexity': 16.3238, 'ref_perplexity': 14.4563}, 'bertscore': {'precision': 83.8064, 'recall': 84.7406, 'f1': 84.263}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.6663, 'rouge2': 5.0112, 'rougeL': 17.2527, 'rougeLsum': 25.8522}, 'ppl': {'perplexity': 7.5371, 'ref_perplexity': 16.1632}, 'bertscore': {'precision': 85.502, 'recall': 84.8716, 'f1': 85.1799}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
Using default tokenizer.
{'rouge': {'rouge1': 25.676, 'rouge2': 3.7189, 'rougeL': 15.4164, 'rougeLsum': 24.8273}, 'ppl': {'perplexity': 10.736, 'ref_perplexity': 14.7294}, 'bertscore': {'precision': 84.0875, 'recall': 84.7935, 'f1': 84.4311}}
{'rouge': {'rouge1': 26.7456, 'rouge2': 4.7813, 'rougeL': 16.7631, 'rougeLsum': 25.906}, 'ppl': {'perplexity': 8.7563, 'ref_perplexity': 15.1396}, 'bertscore': {'precision': 85.3451, 'recall': 84.8963, 'f1': 85.1129}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.5632, 'rouge2': 4.6518, 'rougeL': 16.5632, 'rougeLsum': 25.7991}, 'ppl': {'perplexity': 26.2286, 'ref_perplexity': 14.3706}, 'bertscore': {'precision': 84.9037, 'recall': 84.869, 'f1': 84.8792}}
Using default tokenizer.
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
{'rouge': {'rouge1': 25.6053, 'rouge2': 3.6144, 'rougeL': 15.4092, 'rougeLsum': 24.7506}, 'ppl': {'perplexity': 11.4765, 'ref_perplexity': 15.0614}, 'bertscore': {'precision': 84.2945, 'recall': 84.8062, 'f1': 84.5424}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.2591, 'rouge2': 4.3718, 'rougeL': 16.4104, 'rougeLsum': 25.5391}, 'ppl': {'perplexity': 9.0029, 'ref_perplexity': 13.9161}, 'bertscore': {'precision': 85.0251, 'recall': 84.8412, 'f1': 84.9263}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
Using default tokenizer.
{'rouge': {'rouge1': 25.3516, 'rouge2': 4.0584, 'rougeL': 15.8258, 'rougeLsum': 24.6158}, 'ppl': {'perplexity': 11.0355, 'ref_perplexity': 13.6325}, 'bertscore': {'precision': 84.7249, 'recall': 84.8191, 'f1': 84.7638}}
{'rouge': {'rouge1': 25.809, 'rouge2': 3.6934, 'rougeL': 15.4056, 'rougeLsum': 24.9216}, 'ppl': {'perplexity': 20.5498, 'ref_perplexity': 15.178}, 'bertscore': {'precision': 84.0616, 'recall': 84.7874, 'f1': 84.4154}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.859, 'rouge2': 3.9095, 'rougeL': 15.7254, 'rougeLsum': 24.1053}, 'ppl': {'perplexity': 7.3355, 'ref_perplexity': 13.5244}, 'bertscore': {'precision': 84.9868, 'recall': 84.8255, 'f1': 84.8968}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.4373, 'rouge2': 3.435, 'rougeL': 15.2735, 'rougeLsum': 24.5932}, 'ppl': {'perplexity': 23.1485, 'ref_perplexity': 15.2556}, 'bertscore': {'precision': 84.2089, 'recall': 84.7814, 'f1': 84.4868}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0818, 'rouge2': 4.0917, 'rougeL': 15.9881, 'rougeLsum': 25.3027}, 'ppl': {'perplexity': 6.7604, 'ref_perplexity': 13.5092}, 'bertscore': {'precision': 84.9156, 'recall': 84.8841, 'f1': 84.892}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8




Round 8
Start Training!
Sample 3451 of the training set: {'input_ids': [0, 21714, 1215, 26868, 134, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 2155, 6, 82, 198, 5, 232, 283, 7, 730, 7, 697, 6, 173, 8, 892, 6, 98, 7, 1346, 730, 11, 1110, 9, 63, 4106, 5550, 16, 182, 505, 4, 50118, 10431, 41761, 176, 10431, 35, 38, 1705, 75, 2854, 19, 47, 55, 6, 2722, 4, 1791, 32, 203, 55, 18088, 2088, 87, 144, 13555, 4, 286, 1246, 6, 1791, 1642, 10, 3221, 19, 10, 1056, 15, 15052, 8, 6369, 4905, 4, 50118, 10431, 41761, 134, 10431, 35, 370, 214, 235, 4, 730, 16, 10, 1195, 1736, 5580, 2313, 6, 19, 540, 592, 1164, 7, 18627, 4, 407, 47, 40, 240, 7, 555, 55, 18088, 2088, 8, 7, 1994, 66, 15, 110, 308, 4137, 4, 50118, 10431, 41761, 176, 10431, 35, 2044, 6659, 9, 470, 3650, 16, 1791, 32, 55, 25853, 59, 1081, 980, 4, 407, 77, 47, 32, 1686, 7, 41, 470, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3509, 'rouge2': 3.7597, 'rougeL': 15.5226, 'rougeLsum': 24.545}, 'ppl': {'perplexity': 10.854, 'ref_perplexity': 13.6266}, 'bertscore': {'precision': 84.558, 'recall': 84.775, 'f1': 84.6573}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 26.4658, 'rouge2': 6.065, 'rougeL': 16.933, 'rougeLsum': 25.7065}, 'ppl': {'perplexity': 13.2675, 'ref_perplexity': 29.1685}, 'bertscore': {'precision': 83.8741, 'recall': 84.5985, 'f1': 84.2285}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.5812, 'rouge2': 3.8154, 'rougeL': 15.7928, 'rougeLsum': 24.7657}, 'ppl': {'perplexity': 7.1448, 'ref_perplexity': 13.649}, 'bertscore': {'precision': 84.7151, 'recall': 84.8204, 'f1': 84.7602}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.6345, 'rouge2': 4.2679, 'rougeL': 16.8078, 'rougeLsum': 24.9642}, 'ppl': {'perplexity': 2.3176, 'ref_perplexity': 20.8633}, 'bertscore': {'precision': 84.9866, 'recall': 84.158, 'f1': 84.5677}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6027, 'rouge2': 3.8457, 'rougeL': 15.6824, 'rougeLsum': 24.7753}, 'ppl': {'perplexity': 15.9564, 'ref_perplexity': 13.7538}, 'bertscore': {'precision': 84.6806, 'recall': 84.8975, 'f1': 84.7809}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.0011, 'rouge2': 4.2852, 'rougeL': 17.1273, 'rougeLsum': 24.2761}, 'ppl': {'perplexity': 1.9462, 'ref_perplexity': 17.4777}, 'bertscore': {'precision': 85.2755, 'recall': 84.6514, 'f1': 84.9584}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7717, 'rouge2': 3.9272, 'rougeL': 15.7115, 'rougeLsum': 24.958}, 'ppl': {'perplexity': 26.2769, 'ref_perplexity': 14.0038}, 'bertscore': {'precision': 84.4702, 'recall': 84.8848, 'f1': 84.6694}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.3171, 'rouge2': 4.14, 'rougeL': 15.9201, 'rougeLsum': 24.4518}, 'ppl': {'perplexity': 4.0162, 'ref_perplexity': 15.5945}, 'bertscore': {'precision': 83.4344, 'recall': 84.6653, 'f1': 84.0406}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.5236, 'rouge2': 3.8068, 'rougeL': 15.5989, 'rougeLsum': 24.6715}, 'ppl': {'perplexity': 8.3817, 'ref_perplexity': 14.1822}, 'bertscore': {'precision': 84.3914, 'recall': 84.8318, 'f1': 84.6018}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
Using default tokenizer.
{'rouge': {'rouge1': 23.4176, 'rouge2': 3.9154, 'rougeL': 15.0048, 'rougeLsum': 22.7609}, 'ppl': {'perplexity': 4.5439, 'ref_perplexity': 14.3877}, 'bertscore': {'precision': 83.0652, 'recall': 84.5413, 'f1': 83.7901}}
{'rouge': {'rouge1': 25.1986, 'rouge2': 3.7555, 'rougeL': 15.5147, 'rougeLsum': 24.3832}, 'ppl': {'perplexity': 19.8139, 'ref_perplexity': 14.3586}, 'bertscore': {'precision': 84.4925, 'recall': 84.8256, 'f1': 84.65}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
Using default tokenizer.
{'rouge': {'rouge1': 25.3795, 'rouge2': 3.7865, 'rougeL': 15.4623, 'rougeLsum': 24.5625}, 'ppl': {'perplexity': 18.5102, 'ref_perplexity': 14.432}, 'bertscore': {'precision': 84.453, 'recall': 84.8134, 'f1': 84.624}}
Using default tokenizer.
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 8
  Total eval batch size = 8
{'rouge': {'rouge1': 26.4265, 'rouge2': 4.9023, 'rougeL': 16.5043, 'rougeLsum': 25.7336}, 'ppl': {'perplexity': 8.7577, 'ref_perplexity': 13.7389}, 'bertscore': {'precision': 85.1158, 'recall': 84.9793, 'f1': 85.0431}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6375, 'rouge2': 3.7734, 'rougeL': 15.4888, 'rougeLsum': 24.7498}, 'ppl': {'perplexity': 9.2151, 'ref_perplexity': 14.5372}, 'bertscore': {'precision': 84.4743, 'recall': 84.8496, 'f1': 84.6533}}
Using default tokenizer.
{'rouge': {'rouge1': 24.8489, 'rouge2': 4.0103, 'rougeL': 15.4935, 'rougeLsum': 24.0849}, 'ppl': {'perplexity': 14.004, 'ref_perplexity': 13.3617}, 'bertscore': {'precision': 83.6775, 'recall': 84.786, 'f1': 84.2196}}
Parameter 'function'=<function get_datasets.<locals>.preprocess_function at 0x7b7a3cf384c0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 8
Start Training!
Sample 6390 of the training set: {'input_ids': [0, 21714, 1215, 401, 27873, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 38, 4157, 447, 15, 1619, 6716, 328, 3394, 102, 328, 2315, 10, 7511, 9, 42, 2173, 328, 8814, 11, 1353, 6, 38, 206, 52, 108, 30660, 300, 4288, 10, 1068, 259, 4, 50118, 10431, 41761, 176, 10431, 35, 28515, 8, 5770, 2540, 4, 6319, 47, 57, 4835, 3422, 6, 21958, 116, 50118, 10431, 41761, 134, 10431, 35, 38, 56, 65, 50, 80, 11121, 9, 8380, 282, 2154, 6, 53, 1085, 1493, 4, 50118, 10431, 41761, 176, 10431, 35, 10577, 66, 9, 5, 1155, 6, 2540, 4, 5348, 6, 99, 109, 47, 33, 11, 5, 124, 116, 50118, 10431, 41761, 134, 10431, 35, 1801, 10, 367, 1619, 7420, 6, 128, 42334, 5, 191, 6, 71, 70, 328, 50118, 10431, 41761, 176, 10431, 35, 1599, 75, 185, 14, 6328, 19, 162, 4, 1832, 47, 33, 41, 38199, 13, 209, 1964, 116, 50118, 10431, 41761, 134, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.8496, 'rouge2': 6.1914, 'rougeL': 16.181, 'rougeLsum': 24.2265}, 'ppl': {'perplexity': 39.6963, 'ref_perplexity': 28.887}, 'bertscore': {'precision': 81.9555, 'recall': 83.6978, 'f1': 82.8139}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.95, 'rouge2': 5.2481, 'rougeL': 17.481, 'rougeLsum': 25.4117}, 'ppl': {'perplexity': 2.3844, 'ref_perplexity': 20.6488}, 'bertscore': {'precision': 85.2245, 'recall': 84.838, 'f1': 85.0281}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.6523, 'rouge2': 4.0568, 'rougeL': 15.9629, 'rougeLsum': 23.9598}, 'ppl': {'perplexity': 17.7961, 'ref_perplexity': 17.4487}, 'bertscore': {'precision': 83.8671, 'recall': 84.5704, 'f1': 84.2139}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.8561, 'rouge2': 3.983, 'rougeL': 15.8207, 'rougeLsum': 25.8972}, 'ppl': {'perplexity': 8.9324, 'ref_perplexity': 15.5031}, 'bertscore': {'precision': 83.5924, 'recall': 84.8146, 'f1': 84.1942}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2997, 'rouge2': 4.8801, 'rougeL': 15.7523, 'rougeLsum': 24.6581}, 'ppl': {'perplexity': 18.1476, 'ref_perplexity': 14.4483}, 'bertscore': {'precision': 83.7112, 'recall': 84.7523, 'f1': 84.2246}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.0036, 'rouge2': 3.937, 'rougeL': 15.1754, 'rougeLsum': 24.2495}, 'ppl': {'perplexity': 24.8908, 'ref_perplexity': 13.7535}, 'bertscore': {'precision': 82.9507, 'recall': 84.7921, 'f1': 83.8533}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 23.2217, 'rouge2': 3.4092, 'rougeL': 14.5077, 'rougeLsum': 22.6122}, 'ppl': {'perplexity': 12.51, 'ref_perplexity': 13.2381}, 'bertscore': {'precision': 83.7219, 'recall': 84.5294, 'f1': 84.115}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.427, 'rouge2': 4.1718, 'rougeL': 15.8321, 'rougeLsum': 24.7015}, 'ppl': {'perplexity': 7.4825, 'ref_perplexity': 13.0133}, 'bertscore': {'precision': 84.8507, 'recall': 84.7788, 'f1': 84.8072}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.2114, 'rouge2': 3.8753, 'rougeL': 15.0702, 'rougeLsum': 23.4976}, 'ppl': {'perplexity': 8.7232, 'ref_perplexity': 12.9242}, 'bertscore': {'precision': 84.6595, 'recall': 84.7991, 'f1': 84.7176}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1916, 'rouge2': 4.0604, 'rougeL': 15.5819, 'rougeLsum': 24.4889}, 'ppl': {'perplexity': 11.3778, 'ref_perplexity': 12.8725}, 'bertscore': {'precision': 84.4415, 'recall': 84.7456, 'f1': 84.587}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.7496, 'rouge2': 3.7693, 'rougeL': 15.3124, 'rougeLsum': 24.0835}, 'ppl': {'perplexity': 24.0773, 'ref_perplexity': 13.0129}, 'bertscore': {'precision': 84.1645, 'recall': 84.6619, 'f1': 84.4045}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0323, 'rouge2': 4.0045, 'rougeL': 15.6694, 'rougeLsum': 25.2707}, 'ppl': {'perplexity': 11.065, 'ref_perplexity': 13.163}, 'bertscore': {'precision': 84.4478, 'recall': 84.8484, 'f1': 84.6406}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.0084, 'rouge2': 3.5998, 'rougeL': 15.2112, 'rougeLsum': 24.2414}, 'ppl': {'perplexity': 7.7426, 'ref_perplexity': 13.4559}, 'bertscore': {'precision': 84.2287, 'recall': 84.7435, 'f1': 84.4771}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.5026, 'rouge2': 3.7178, 'rougeL': 15.4996, 'rougeLsum': 24.6964}, 'ppl': {'perplexity': 15.9972, 'ref_perplexity': 13.6209}, 'bertscore': {'precision': 84.3159, 'recall': 84.7896, 'f1': 84.5437}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.5304, 'rouge2': 3.8951, 'rougeL': 15.376, 'rougeLsum': 24.7542}, 'ppl': {'perplexity': 12.2597, 'ref_perplexity': 13.8683}, 'bertscore': {'precision': 84.0301, 'recall': 84.7832, 'f1': 84.3964}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1761, 'rouge2': 3.5294, 'rougeL': 15.2431, 'rougeLsum': 24.3266}, 'ppl': {'perplexity': 12.3808, 'ref_perplexity': 14.2096}, 'bertscore': {'precision': 84.1533, 'recall': 84.8028, 'f1': 84.468}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2732, 'rouge2': 3.6043, 'rougeL': 15.3495, 'rougeLsum': 24.4057}, 'ppl': {'perplexity': 12.5171, 'ref_perplexity': 14.4765}, 'bertscore': {'precision': 84.2935, 'recall': 84.7597, 'f1': 84.5171}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2506, 'rouge2': 3.4696, 'rougeL': 15.1833, 'rougeLsum': 24.415}, 'ppl': {'perplexity': 12.8756, 'ref_perplexity': 14.704}, 'bertscore': {'precision': 84.2006, 'recall': 84.7783, 'f1': 84.4805}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2017, 'rouge2': 3.5384, 'rougeL': 15.2566, 'rougeLsum': 24.3525}, 'ppl': {'perplexity': 10.5428, 'ref_perplexity': 14.8809}, 'bertscore': {'precision': 84.0727, 'recall': 84.7684, 'f1': 84.4111}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2831, 'rouge2': 3.5488, 'rougeL': 15.2364, 'rougeLsum': 24.4088}, 'ppl': {'perplexity': 14.1327, 'ref_perplexity': 14.9167}, 'bertscore': {'precision': 84.0525, 'recall': 84.7692, 'f1': 84.4008}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 9
Start Training!
Sample 4069 of the training set: {'input_ids': [0, 21714, 1215, 1749, 4563, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 12289, 3066, 18567, 6, 38, 2220, 75, 450, 47, 13, 10, 251, 86, 4, 653, 33, 47, 57, 608, 13, 5, 375, 367, 377, 4, 50118, 10431, 41761, 176, 10431, 35, 10385, 3571, 6, 38, 348, 57, 608, 132, 1315, 148, 186, 7033, 8, 277, 633, 15, 5, 983, 6, 24, 18, 269, 326, 9798, 4, 50118, 10431, 41761, 134, 10431, 35, 2612, 32, 47, 447, 98, 543, 116, 50118, 10431, 41761, 176, 10431, 35, 38, 437, 6549, 418, 13, 10, 1805, 7, 2627, 4, 38, 236, 7, 1930, 103, 86, 19, 127, 6096, 17990, 89, 6, 141, 59, 47, 116, 50118, 10431, 41761, 134, 10431, 35, 38, 33, 57, 447, 25, 10, 38296, 4, 24259, 127, 521, 2017, 38, 619, 1372, 8, 2602, 4, 50118, 10431, 41761, 176, 10431, 35, 280, 4428, 372, 4, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.0139, 'rouge2': 6.1486, 'rougeL': 18.0877, 'rougeLsum': 26.3168}, 'ppl': {'perplexity': 1.9279, 'ref_perplexity': 27.0578}, 'bertscore': {'precision': 84.302, 'recall': 84.3789, 'f1': 84.3359}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 28.3537, 'rouge2': 5.8758, 'rougeL': 17.303, 'rougeLsum': 27.4488}, 'ppl': {'perplexity': 2.7922, 'ref_perplexity': 19.5349}, 'bertscore': {'precision': 83.7421, 'recall': 84.9867, 'f1': 84.3559}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.6053, 'rouge2': 4.9547, 'rougeL': 16.9466, 'rougeLsum': 25.6798}, 'ppl': {'perplexity': 2.8071, 'ref_perplexity': 16.3714}, 'bertscore': {'precision': 85.6918, 'recall': 85.0386, 'f1': 85.3603}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.2276, 'rouge2': 4.8475, 'rougeL': 17.2551, 'rougeLsum': 26.5425}, 'ppl': {'perplexity': 2.7358, 'ref_perplexity': 14.6939}, 'bertscore': {'precision': 84.7372, 'recall': 85.0068, 'f1': 84.8676}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 23.6125, 'rouge2': 4.3489, 'rougeL': 15.3067, 'rougeLsum': 22.9322}, 'ppl': {'perplexity': 7.2579, 'ref_perplexity': 13.7196}, 'bertscore': {'precision': 85.1122, 'recall': 84.7762, 'f1': 84.9311}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 21.2649, 'rouge2': 3.149, 'rougeL': 13.6458, 'rougeLsum': 20.6357}, 'ppl': {'perplexity': 14.956, 'ref_perplexity': 13.0242}, 'bertscore': {'precision': 82.9948, 'recall': 84.7501, 'f1': 83.8438}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6403, 'rouge2': 3.949, 'rougeL': 15.6754, 'rougeLsum': 24.9604}, 'ppl': {'perplexity': 5.819, 'ref_perplexity': 12.725}, 'bertscore': {'precision': 84.378, 'recall': 84.9029, 'f1': 84.6336}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.6278, 'rouge2': 4.4136, 'rougeL': 15.5921, 'rougeLsum': 24.9987}, 'ppl': {'perplexity': 22.6136, 'ref_perplexity': 12.5977}, 'bertscore': {'precision': 84.1006, 'recall': 84.8879, 'f1': 84.4864}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.478, 'rouge2': 3.9792, 'rougeL': 15.3193, 'rougeLsum': 23.8455}, 'ppl': {'perplexity': 12.9288, 'ref_perplexity': 12.5644}, 'bertscore': {'precision': 84.2434, 'recall': 84.9545, 'f1': 84.5906}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.4621, 'rouge2': 4.4797, 'rougeL': 16.4759, 'rougeLsum': 25.652}, 'ppl': {'perplexity': 12.1073, 'ref_perplexity': 12.7786}, 'bertscore': {'precision': 84.8049, 'recall': 85.0388, 'f1': 84.9161}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.8832, 'rouge2': 3.6972, 'rougeL': 15.417, 'rougeLsum': 24.0401}, 'ppl': {'perplexity': 10.5445, 'ref_perplexity': 12.8981}, 'bertscore': {'precision': 84.1504, 'recall': 84.8447, 'f1': 84.4878}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.1542, 'rouge2': 4.4096, 'rougeL': 15.9914, 'rougeLsum': 25.2707}, 'ppl': {'perplexity': 9.563, 'ref_perplexity': 13.1818}, 'bertscore': {'precision': 84.312, 'recall': 84.9115, 'f1': 84.6037}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.3842, 'rouge2': 4.2351, 'rougeL': 15.6362, 'rougeLsum': 25.5865}, 'ppl': {'perplexity': 12.4844, 'ref_perplexity': 13.4829}, 'bertscore': {'precision': 83.7999, 'recall': 84.9124, 'f1': 84.3465}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7202, 'rouge2': 3.783, 'rougeL': 15.4322, 'rougeLsum': 24.8662}, 'ppl': {'perplexity': 18.6039, 'ref_perplexity': 13.7947}, 'bertscore': {'precision': 83.9966, 'recall': 84.8825, 'f1': 84.4302}}
Parameter 'function'=<function get_datasets.<locals>.preprocess_function at 0x7da3d20271f0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Parameter 'function'=<function get_datasets.<locals>.preprocess_function at 0x7305334930d0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4





Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 9
Start Training!
Sample 1843 of the training set: {'input_ids': [0, 21714, 1215, 1366, 3897, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 3394, 9083, 5, 4320, 116, 50118, 10431, 41761, 176, 10431, 35, 38, 218, 75, 216, 2230, 4, 38, 129, 1798, 24, 18, 20959, 30, 10, 3395, 822, 999, 4, 50118, 10431, 41761, 134, 10431, 35, 8901, 24, 33, 10, 739, 17268, 116, 50118, 10431, 41761, 176, 10431, 35, 3216, 6, 98, 24, 269, 630, 75, 948, 54, 1523, 5, 418, 4, 20, 2225, 1495, 16, 9361, 4, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 28.7013, 'rouge2': 5.8527, 'rougeL': 17.8169, 'rougeLsum': 28.0321}, 'ppl': {'perplexity': 3.5758, 'ref_perplexity': 27.0353}, 'bertscore': {'precision': 84.6577, 'recall': 84.1494, 'f1': 84.3986}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.0846, 'rouge2': 5.2035, 'rougeL': 18.1115, 'rougeLsum': 26.1816}, 'ppl': {'perplexity': 3.5951, 'ref_perplexity': 19.3132}, 'bertscore': {'precision': 85.4802, 'recall': 84.9818, 'f1': 85.2258}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.3823, 'rouge2': 3.7258, 'rougeL': 15.7495, 'rougeLsum': 23.5479}, 'ppl': {'perplexity': 11.6192, 'ref_perplexity': 16.2688}, 'bertscore': {'precision': 83.7965, 'recall': 84.6436, 'f1': 84.2119}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2314, 'rouge2': 4.0276, 'rougeL': 16.2542, 'rougeLsum': 24.5717}, 'ppl': {'perplexity': 4.1904, 'ref_perplexity': 14.5779}, 'bertscore': {'precision': 84.2555, 'recall': 84.7229, 'f1': 84.4819}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.047, 'rouge2': 4.7483, 'rougeL': 16.3557, 'rougeLsum': 25.4396}, 'ppl': {'perplexity': 16.0367, 'ref_perplexity': 13.6}, 'bertscore': {'precision': 84.1854, 'recall': 84.9788, 'f1': 84.5755}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.4773, 'rouge2': 3.9894, 'rougeL': 15.1166, 'rougeLsum': 23.6632}, 'ppl': {'perplexity': 9.9219, 'ref_perplexity': 12.9664}, 'bertscore': {'precision': 83.1627, 'recall': 84.8279, 'f1': 83.9784}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2518, 'rouge2': 3.9454, 'rougeL': 15.5849, 'rougeLsum': 24.4413}, 'ppl': {'perplexity': 9.9862, 'ref_perplexity': 12.6459}, 'bertscore': {'precision': 83.6692, 'recall': 84.8343, 'f1': 84.2409}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.1314, 'rouge2': 3.9642, 'rougeL': 15.3669, 'rougeLsum': 23.4569}, 'ppl': {'perplexity': 10.3783, 'ref_perplexity': 12.4769}, 'bertscore': {'precision': 84.3939, 'recall': 84.896, 'f1': 84.6362}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.1131, 'rouge2': 4.6198, 'rougeL': 16.6638, 'rougeLsum': 26.3399}, 'ppl': {'perplexity': 12.5121, 'ref_perplexity': 12.5243}, 'bertscore': {'precision': 84.8173, 'recall': 84.9251, 'f1': 84.8649}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.1717, 'rouge2': 3.9378, 'rougeL': 15.8324, 'rougeLsum': 25.3496}, 'ppl': {'perplexity': 18.2803, 'ref_perplexity': 12.6476}, 'bertscore': {'precision': 83.9799, 'recall': 84.92, 'f1': 84.4403}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.5264, 'rouge2': 3.8828, 'rougeL': 15.5552, 'rougeLsum': 24.7488}, 'ppl': {'perplexity': 95.8643, 'ref_perplexity': 12.923}, 'bertscore': {'precision': 84.5325, 'recall': 84.8135, 'f1': 84.6631}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.6249, 'rouge2': 4.3029, 'rougeL': 16.0622, 'rougeLsum': 25.8092}, 'ppl': {'perplexity': 13.0492, 'ref_perplexity': 13.2239}, 'bertscore': {'precision': 83.9919, 'recall': 84.884, 'f1': 84.4291}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.6554, 'rouge2': 3.4962, 'rougeL': 15.0826, 'rougeLsum': 23.8452}, 'ppl': {'perplexity': 24.6421, 'ref_perplexity': 13.3717}, 'bertscore': {'precision': 83.8296, 'recall': 84.8533, 'f1': 84.3309}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.7199, 'rouge2': 4.0565, 'rougeL': 15.9395, 'rougeLsum': 25.8688}, 'ppl': {'perplexity': 25.8783, 'ref_perplexity': 13.7455}, 'bertscore': {'precision': 84.2275, 'recall': 84.9719, 'f1': 84.5913}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7084, 'rouge2': 3.7501, 'rougeL': 15.4534, 'rougeLsum': 24.903}, 'ppl': {'perplexity': 20.598, 'ref_perplexity': 14.1468}, 'bertscore': {'precision': 84.2882, 'recall': 84.9081, 'f1': 84.5892}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4623, 'rouge2': 3.5994, 'rougeL': 15.3255, 'rougeLsum': 24.643}, 'ppl': {'perplexity': 13.5113, 'ref_perplexity': 14.5164}, 'bertscore': {'precision': 84.1486, 'recall': 84.8911, 'f1': 84.5105}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.644, 'rouge2': 3.5825, 'rougeL': 15.4944, 'rougeLsum': 24.8069}, 'ppl': {'perplexity': 12.3526, 'ref_perplexity': 14.7383}, 'bertscore': {'precision': 84.1846, 'recall': 84.8957, 'f1': 84.5308}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0314, 'rouge2': 3.7205, 'rougeL': 15.4681, 'rougeLsum': 25.1881}, 'ppl': {'perplexity': 321.0139, 'ref_perplexity': 15.0437}, 'bertscore': {'precision': 84.1568, 'recall': 84.9087, 'f1': 84.5239}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.7922, 'rouge2': 3.5813, 'rougeL': 15.3304, 'rougeLsum': 24.9516}, 'ppl': {'perplexity': 40.1325, 'ref_perplexity': 15.2146}, 'bertscore': {'precision': 83.9534, 'recall': 84.8782, 'f1': 84.4056}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.0751, 'rouge2': 3.6695, 'rougeL': 15.5588, 'rougeLsum': 25.2064}, 'ppl': {'perplexity': 33.9708, 'ref_perplexity': 15.2845}, 'bertscore': {'precision': 84.1079, 'recall': 84.9041, 'f1': 84.4968}}

Start Predicting!
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4




Round 10
Start Training!
Sample 3177 of the training set: {'input_ids': [0, 21714, 1215, 246, 28129, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 2497, 1390, 4, 99, 64, 38, 109, 13, 47, 116, 50118, 10431, 41761, 176, 10431, 35, 38, 236, 7, 1339, 62, 127, 7398, 257, 6058, 4, 50118, 10431, 41761, 134, 10431, 35, 392, 38, 33, 110, 762, 2540, 116, 50118, 10431, 41761, 176, 10431, 35, 9136, 4, 1398, 47, 32, 4, 50118, 10431, 41761, 134, 10431, 35, 1398, 16, 110, 5130, 4, 1534, 14, 235, 116, 50118, 10431, 41761, 176, 10431, 35, 3216, 6, 3392, 47, 4, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.583, 'rouge2': 6.4469, 'rougeL': 17.342, 'rougeLsum': 26.7875}, 'ppl': {'perplexity': 78.5275, 'ref_perplexity': 26.8254}, 'bertscore': {'precision': 82.7595, 'recall': 84.0653, 'f1': 83.4024}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 18.8167, 'rouge2': 2.9761, 'rougeL': 14.0028, 'rougeLsum': 18.2572}, 'ppl': {'perplexity': 1.281, 'ref_perplexity': 19.142}, 'bertscore': {'precision': 87.512, 'recall': 84.5865, 'f1': 86.0206}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.7038, 'rouge2': 4.5253, 'rougeL': 17.206, 'rougeLsum': 26.0958}, 'ppl': {'perplexity': 3.9796, 'ref_perplexity': 16.1628}, 'bertscore': {'precision': 85.543, 'recall': 84.8765, 'f1': 85.2048}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3988, 'rouge2': 4.4639, 'rougeL': 16.3017, 'rougeLsum': 24.6815}, 'ppl': {'perplexity': 6.2909, 'ref_perplexity': 14.4427}, 'bertscore': {'precision': 84.2966, 'recall': 84.8722, 'f1': 84.5772}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 27.1069, 'rouge2': 4.8333, 'rougeL': 17.1194, 'rougeLsum': 26.369}, 'ppl': {'perplexity': 7.5163, 'ref_perplexity': 13.3584}, 'bertscore': {'precision': 84.4201, 'recall': 85.1149, 'f1': 84.761}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.557, 'rouge2': 4.9099, 'rougeL': 16.5295, 'rougeLsum': 25.8793}, 'ppl': {'perplexity': 7.3887, 'ref_perplexity': 12.7491}, 'bertscore': {'precision': 84.7395, 'recall': 84.8629, 'f1': 84.7958}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.317, 'rouge2': 4.5834, 'rougeL': 16.2628, 'rougeLsum': 25.5817}, 'ppl': {'perplexity': 38.6501, 'ref_perplexity': 12.403}, 'bertscore': {'precision': 84.2104, 'recall': 84.8228, 'f1': 84.5107}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.9714, 'rouge2': 3.7989, 'rougeL': 15.7686, 'rougeLsum': 24.2502}, 'ppl': {'perplexity': 5.8151, 'ref_perplexity': 12.231}, 'bertscore': {'precision': 84.737, 'recall': 84.8683, 'f1': 84.7962}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 23.3169, 'rouge2': 3.6228, 'rougeL': 14.1956, 'rougeLsum': 22.7047}, 'ppl': {'perplexity': 16.2094, 'ref_perplexity': 12.2479}, 'bertscore': {'precision': 83.0776, 'recall': 84.6071, 'f1': 83.8274}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.4997, 'rouge2': 4.0621, 'rougeL': 15.2708, 'rougeLsum': 24.7491}, 'ppl': {'perplexity': 42.9802, 'ref_perplexity': 12.3521}, 'bertscore': {'precision': 83.6408, 'recall': 84.8344, 'f1': 84.2284}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.2466, 'rouge2': 3.9107, 'rougeL': 15.4344, 'rougeLsum': 24.4843}, 'ppl': {'perplexity': 61.1058, 'ref_perplexity': 12.5882}, 'bertscore': {'precision': 83.8282, 'recall': 84.771, 'f1': 84.2892}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1125, 'rouge2': 3.8001, 'rougeL': 15.5202, 'rougeLsum': 24.3301}, 'ppl': {'perplexity': 11.8771, 'ref_perplexity': 12.7959}, 'bertscore': {'precision': 84.2372, 'recall': 84.8287, 'f1': 84.5244}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.1967, 'rouge2': 3.7607, 'rougeL': 15.3874, 'rougeLsum': 24.3909}, 'ppl': {'perplexity': 21.1684, 'ref_perplexity': 13.0344}, 'bertscore': {'precision': 83.9256, 'recall': 84.7808, 'f1': 84.3432}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.5604, 'rouge2': 3.5187, 'rougeL': 15.0739, 'rougeLsum': 23.7699}, 'ppl': {'perplexity': 53.995, 'ref_perplexity': 13.2817}, 'bertscore': {'precision': 84.0711, 'recall': 84.8016, 'f1': 84.4271}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.9124, 'rouge2': 3.535, 'rougeL': 15.2091, 'rougeLsum': 24.0692}, 'ppl': {'perplexity': 31.8337, 'ref_perplexity': 13.647}, 'bertscore': {'precision': 83.7784, 'recall': 84.7505, 'f1': 84.2548}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.5745, 'rouge2': 3.4482, 'rougeL': 15.0568, 'rougeLsum': 23.7796}, 'ppl': {'perplexity': 31.5293, 'ref_perplexity': 13.8342}, 'bertscore': {'precision': 84.0209, 'recall': 84.8153, 'f1': 84.4084}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.3976, 'rouge2': 3.5221, 'rougeL': 15.28, 'rougeLsum': 24.5524}, 'ppl': {'perplexity': 42.8768, 'ref_perplexity': 14.2041}, 'bertscore': {'precision': 83.9043, 'recall': 84.7809, 'f1': 84.333}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.0754, 'rouge2': 3.4373, 'rougeL': 15.2327, 'rougeLsum': 24.2384}, 'ppl': {'perplexity': 104.1189, 'ref_perplexity': 14.4032}, 'bertscore': {'precision': 84.0268, 'recall': 84.7872, 'f1': 84.3973}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 24.9914, 'rouge2': 3.488, 'rougeL': 15.162, 'rougeLsum': 24.137}, 'ppl': {'perplexity': 142.4385, 'ref_perplexity': 14.5282}, 'bertscore': {'precision': 84.0626, 'recall': 84.797, 'f1': 84.4198}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.0267, 'rouge2': 3.4203, 'rougeL': 15.2244, 'rougeLsum': 24.202}, 'ppl': {'perplexity': 24.453, 'ref_perplexity': 14.5881}, 'bertscore': {'precision': 84.004, 'recall': 84.7704, 'f1': 84.3777}}
Parameter 'function'=<function get_datasets.<locals>.preprocess_function at 0x713b1423b700> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
Round 1
Start Training!
Sample 4773 of the training set: {'input_ids': [0, 21714, 1215, 401, 36632, 2], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [0, 10431, 41761, 134, 10431, 35, 2497, 662, 6, 427, 4, 4171, 4, 1308, 766, 16, 2708, 1547, 4, 50118, 10431, 41761, 176, 10431, 35, 2497, 662, 6, 2135, 4, 1547, 4, 4624, 10, 2418, 6, 2540, 4, 50118, 10431, 41761, 134, 10431, 35, 3837, 47, 4, 50118, 10431, 41761, 176, 10431, 35, 2647, 6, 2135, 4, 1547, 6, 115, 47, 2540, 1137, 162, 59, 2512, 116, 50118, 10431, 41761, 134, 10431, 35, 3216, 6, 9, 768, 6, 38, 437, 504, 107, 793, 8, 95, 8505, 31, 9558, 1863, 835, 4, 38, 1166, 110, 2329, 4, 11, 5, 2924, 8, 216, 14, 47, 32, 546, 13, 10, 2971, 4, 50118, 10431, 41761, 176, 10431, 35, 9918, 47, 1137, 162, 99, 47, 64, 109, 116, 50118, 10431, 41761, 134, 10431, 35, 38, 64, 109, 3046, 10, 2971, 16, 421, 7, 109, 6, 215, 25, 29691, 6, 2806, 1028, 1519, 6, 2]}.
***** Running training *****
  Num examples = 11214
  Num Epochs = 20
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 28040
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 26.7831, 'rouge2': 6.448, 'rougeL': 17.2104, 'rougeLsum': 26.0615}, 'ppl': {'perplexity': 16.2545, 'ref_perplexity': 27.6512}, 'bertscore': {'precision': 82.6542, 'recall': 84.1225, 'f1': 83.378}}
***** Running testing *****
  Num examples = 1246
  Instantaneous batch size per device = 4
  Total eval batch size = 4
Using default tokenizer.
{'rouge': {'rouge1': 25.9614, 'rouge2': 5.7668, 'rougeL': 17.4439, 'rougeLsum': 25.2807}, 'ppl': {'perplexity': 4.9333, 'ref_perplexity': 19.8494}, 'bertscore': {'precision': 85.3581, 'recall': 84.5513, 'f1': 84.9492}}
